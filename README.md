# keybd-sleep

Windows GUI アプリ。  
PCをスリープ状態にします。
キーボードイベントを送信し、Windows の「クイックリンクメニュー」の「シャットダウンまたはサインアウト」メニューからスリープ動作を実行します。
キーボードイベント送信後、即終了し、常駐等は行いません。

## コマンドライン

```
Usage: KeybdSleep.exe [/N] [/Q] [milliseconds]
```

## オプション

* /N = 実際のスリープ操作を行わない
* /Q = 確認ダイアログを出さない
* 数値 = キー送信間の待ち時間（ミリ秒）

## `SetSuspendState` との違い

Windowsの `SetSuspendState`（APIやコマンド）とスタートメニューの「スリープ」は、システムの挙動や「休止状態（ハイバーネーション）」の設定によって結果が大きく異なります。
にもかかわらず、スタートメニューの「スリープ」と同じ挙動をする公開された単一のAPIがないため、このアプリではユーザー操作を再現して、スリープに移行させることを実現しています。

主な違いは以下の通りです。

### 1. 休止状態の設定による挙動の変化

最も大きな違いは、**休止状態が有効な場合の挙動**です。

* スタートメニューの「スリープ」
  * 休止状態の設定に関わらず、常に**スリープ**（S3など）を実行します。
  * メモリにデータを保持し、素早く復帰できます。

* `SetSuspendState` (引数なし/標準)
  * **休止状態が有効な場合**、スリープではなく「**休止状態**」に入ってしまいます。
  * HDD/SSDにデータを書き出し、電源を完全に切るため、復帰に時間がかかります。 

### 2. ハイブリッドスリープの扱い

デスクトップPCなどで「スリープしつつ、停電に備えてディスクにも保存する」**ハイブリッドスリープ**の扱いも異なります。

* スタートメニューの「スリープ」
  * 設定で有効になっていれば、自動的にハイブリッドスリープ（メモリとディスクの両方に保存）を適用します。

* `SetSuspendState`
  * 明示的に指定しない限り、OS標準のハイブリッドスリープ設定を無視して「休止」か「通常スリープ」のどちらかに倒れる傾向があります。 

## Licence

This software is released under the MIT License, see LICENSE.
